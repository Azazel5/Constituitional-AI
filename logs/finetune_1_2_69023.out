================================
Language Model Fine-tuning
Job ID: 69023
Model: qwen
Selection: contextual
Data File: Data_Processing/CAI/data/constitutional_training_data_qwen-contextual-True.jsonl
Node: pax007
Started: Sun Nov  9 01:34:04 PM EST 2025
================================

Working Directory set to: /cluster/home/supadh03/CAI/Constituitional-AI
Output directory is: models/finetuned
================================================================================
Constitutional AI Fine-Tuning
================================================================================
Base model: Qwen/Qwen2.5-3B-Instruct
Selection method: contextual
Data file: Data_Processing/CAI/data/constitutional_training_data_qwen-contextual-True.jsonl
Output directory: models/finetuned/qwen_contextual
Validation size: 79

Loading training data...
Loaded 979 examples
Loading existing split from models/finetuned/train_val_split.json...
✓ Using seed 42
Train: 900 examples
Validation: 79 examples
✓ Validation prompts verified consistent across datasets

Preparing training data...
✓ Training dataset: 900 examples
✓ Validation dataset: 79 examples

Loading Qwen/Qwen2.5-3B-Instruct...
✓ CUDA available
✓ GPU: NVIDIA A100 80GB PCIe

✓ Model loaded: cuda:0
✓ Parameters: 3.09B

Tokenizing data...
✓ Tokenization complete

================================================================================
Starting Training
================================================================================

{'loss': 1.3109, 'grad_norm': 5.26171875, 'learning_rate': 8.079470198675497e-07, 'epoch': 0.89}
{'eval_loss': 1.3767914772033691, 'eval_runtime': 3.8889, 'eval_samples_per_second': 20.314, 'eval_steps_per_second': 20.314, 'epoch': 0.89}
{'loss': 0.9695, 'grad_norm': 3.6875, 'learning_rate': 4.768211920529801e-07, 'epoch': 1.76}
{'eval_loss': 1.181896448135376, 'eval_runtime': 3.9007, 'eval_samples_per_second': 20.253, 'eval_steps_per_second': 20.253, 'epoch': 1.76}
{'loss': 0.5803, 'grad_norm': 2.294921875, 'learning_rate': 1.4569536423841058e-07, 'epoch': 2.64}
{'eval_loss': 1.1919550895690918, 'eval_runtime': 3.9001, 'eval_samples_per_second': 20.256, 'eval_steps_per_second': 20.256, 'epoch': 2.64}
{'train_runtime': 533.5268, 'train_samples_per_second': 5.061, 'train_steps_per_second': 0.321, 'train_loss': 0.8915471640246654, 'epoch': 3.0}

================================================================================
Training Complete!
================================================================================

Saving model to models/finetuned/qwen_contextual...
✓ Model saved to models/finetuned/qwen_contextual
✓ Training info saved

================================================================================
Fine-tuning Complete!
================================================================================

================================
Job completed: Sun Nov  9 01:43:27 PM EST 2025
================================
